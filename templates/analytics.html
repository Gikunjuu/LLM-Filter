{% extends "base.html" %}

{% block title %}Analytics - Compliance Filter{% endblock %}

{% block extra_css %}
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
    .page-header {
        margin-bottom: 32px;
    }
    
    .page-title {
        font-size: 32px;
        font-weight: 800;
        letter-spacing: -1px;
        margin-bottom: 8px;
        color: var(--gray-900);
    }
    
    .page-subtitle {
        font-size: 16px;
        color: var(--gray-500);
        font-weight: 400;
    }
    
    .kpi-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 20px;
        margin-bottom: 32px;
    }
    
    .kpi-card {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(20px) saturate(180%);
        -webkit-backdrop-filter: blur(20px) saturate(180%);
        border: 1px solid var(--gray-200);
        border-radius: var(--radius-lg);
        padding: 24px;
        box-shadow: var(--shadow);
        text-align: center;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .kpi-card:hover {
        box-shadow: var(--shadow-lg);
        transform: translateY(-4px);
    }
    
    .kpi-icon {
        width: 56px;
        height: 56px;
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 28px;
        margin: 0 auto 16px;
    }
    
    .kpi-icon.primary { background: linear-gradient(135deg, rgba(0, 122, 255, 0.1) 0%, rgba(0, 122, 255, 0.05) 100%); color: var(--primary); }
    .kpi-icon.success { background: linear-gradient(135deg, rgba(52, 199, 89, 0.1) 0%, rgba(52, 199, 89, 0.05) 100%); color: var(--success); }
    .kpi-icon.warning { background: linear-gradient(135deg, rgba(255, 149, 0, 0.1) 0%, rgba(255, 149, 0, 0.05) 100%); color: var(--warning); }
    .kpi-icon.danger { background: linear-gradient(135deg, rgba(255, 59, 48, 0.1) 0%, rgba(255, 59, 48, 0.05) 100%); color: var(--danger); }
    .kpi-icon.info { background: linear-gradient(135deg, rgba(90, 200, 250, 0.1) 0%, rgba(90, 200, 250, 0.05) 100%); color: var(--info); }
    .kpi-icon.secondary { background: linear-gradient(135deg, rgba(88, 86, 214, 0.1) 0%, rgba(88, 86, 214, 0.05) 100%); color: var(--secondary); }
    
    .kpi-label {
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: var(--gray-500);
        margin-bottom: 8px;
    }
    
    .kpi-value {
        font-size: 28px;
        font-weight: 700;
        letter-spacing: -1px;
        color: var(--gray-900);
        margin-bottom: 8px;
    }
    
    .kpi-trend {
        font-size: 12px;
        font-weight: 600;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 4px;
    }
    
    .kpi-trend.up { color: var(--success); }
    .kpi-trend.down { color: var(--danger); }
    .kpi-trend.stable { color: var(--gray-500); }
    
    .chart-container {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(20px) saturate(180%);
        -webkit-backdrop-filter: blur(20px) saturate(180%);
        border: 1px solid var(--gray-200);
        border-radius: var(--radius-lg);
        padding: 32px;
        box-shadow: var(--shadow);
        margin-bottom: 32px;
    }
    
    .chart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
    }
    
    .chart-title {
        font-size: 18px;
        font-weight: 700;
        color: var(--gray-900);
        letter-spacing: -0.5px;
    }
    
    .chart-area {
        height: 300px;
        position: relative;
    }
    
    .table-container {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(20px) saturate(180%);
        -webkit-backdrop-filter: blur(20px) saturate(180%);
        border: 1px solid var(--gray-200);
        border-radius: var(--radius-lg);
        padding: 32px;
        box-shadow: var(--shadow);
        overflow: hidden;
    }
    
    table {
        width: 100%;
        border-collapse: collapse;
    }
    
    thead {
        background: var(--gray-50);
    }
    
    th {
        padding: 12px 16px;
        text-align: left;
        font-size: 12px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: var(--gray-500);
        border-bottom: 1px solid var(--gray-200);
    }
    
    td {
        padding: 16px;
        border-bottom: 1px solid var(--gray-100);
        font-size: 14px;
        color: var(--gray-700);
    }
    
    tr:hover {
        background: var(--gray-50);
    }
    
    /* Dark Mode Styles - High Contrast */
    [data-theme="dark"] .page-title {
        color: #FFFFFF;
    }
    
    [data-theme="dark"] .page-subtitle {
        color: #B0B0B0;
    }
    
    [data-theme="dark"] .kpi-card {
        background: #0F0F0F;
        border: 1px solid rgba(255, 255, 255, 0.25);
    }
    
    [data-theme="dark"] .kpi-value {
        color: #FFFFFF;
    }
    
    [data-theme="dark"] .kpi-label {
        color: #B0B0B0;
    }
    
    [data-theme="dark"] .kpi-trend {
        color: #FFFFFF;
    }
    
    [data-theme="dark"] .kpi-trend.up {
        color: #30D158;
    }
    
    [data-theme="dark"] .kpi-trend.down {
        color: #FF453A;
    }
    
    [data-theme="dark"] .kpi-trend.stable {
        color: #B0B0B0;
    }
    
    [data-theme="dark"] .chart-container {
        background: #0F0F0F;
        border: 1px solid rgba(255, 255, 255, 0.25);
    }
    
    [data-theme="dark"] .chart-title {
        color: #FFFFFF;
    }
    
    [data-theme="dark"] .table-container {
        background: #0F0F0F;
        border: 1px solid rgba(255, 255, 255, 0.25);
    }
    
    [data-theme="dark"] .badge-premium {
        color: #FFFFFF;
    }
    </style>
{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="page-header">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
            <h1 class="page-title">Analytics & Insights</h1>
            <p class="page-subtitle">Comprehensive analysis of system performance and threat patterns</p>
        </div>
        <div style="display: flex; align-items: center; gap: 16px;">
            <select class="form-control-premium" id="time-range" style="width: 180px;">
                            <option value="24h">Last 24 Hours</option>
                            <option value="7d" selected>Last 7 Days</option>
                            <option value="30d">Last 30 Days</option>
                            <option value="90d">Last 90 Days</option>
                        </select>
            <button class="btn-premium btn-premium-primary" onclick="refreshAnalytics()">
                <i class="bi bi-arrow-clockwise"></i>
                Refresh
                        </button>
                    </div>
                </div>
            </div>

<!-- Key Performance Indicators -->
<div class="kpi-grid">
    <div class="kpi-card">
        <div class="kpi-icon primary">
            <i class="bi bi-speedometer"></i>
        </div>
        <div class="kpi-label">System Performance</div>
        <div class="kpi-value">98.5%</div>
        <div class="kpi-trend up">
                            <i class="bi bi-arrow-up"></i> +2.1%
                        </div>
                    </div>
    
    <div class="kpi-card">
        <div class="kpi-icon success">
            <i class="bi bi-shield-check"></i>
                </div>
        <div class="kpi-label">Detection Accuracy</div>
        <div class="kpi-value">99.2%</div>
        <div class="kpi-trend up">
                            <i class="bi bi-arrow-up"></i> +0.8%
                        </div>
                    </div>
    
    <div class="kpi-card">
        <div class="kpi-icon warning">
            <i class="bi bi-lightning-charge"></i>
                </div>
        <div class="kpi-label">Avg Response</div>
        <div class="kpi-value">245ms</div>
        <div class="kpi-trend down">
                            <i class="bi bi-arrow-down"></i> -12ms
                        </div>
                    </div>
    
    <div class="kpi-card">
        <div class="kpi-icon danger">
            <i class="bi bi-exclamation-triangle"></i>
                </div>
        <div class="kpi-label">False Positives</div>
        <div class="kpi-value">0.8%</div>
        <div class="kpi-trend down">
                            <i class="bi bi-arrow-down"></i> -0.2%
                        </div>
                    </div>
    
    <div class="kpi-card">
        <div class="kpi-icon info">
            <i class="bi bi-cpu"></i>
                </div>
        <div class="kpi-label">Throughput</div>
        <div class="kpi-value">1,247/h</div>
        <div class="kpi-trend up">
                            <i class="bi bi-arrow-up"></i> +15%
                        </div>
                    </div>
    
    <div class="kpi-card">
        <div class="kpi-icon secondary">
            <i class="bi bi-award"></i>
                </div>
        <div class="kpi-label">Overall Score</div>
        <div class="kpi-value">A+</div>
        <div class="kpi-trend stable">
                            <i class="bi bi-dash"></i> Stable
                        </div>
                    </div>
                </div>

<!-- Charts Row 1 -->
<div style="display: grid; grid-template-columns: 2fr 1fr; gap: 32px; margin-bottom: 32px;">
    <!-- Threat Detection Trends -->
    <div class="chart-container">
        <div class="chart-header">
            <h3 class="chart-title">Threat Detection Trends</h3>
            <div style="display: flex; gap: 8px;">
                <button class="btn-premium" style="padding: 8px 16px; font-size: 13px;" onclick="toggleChartType('line')">Line</button>
                <button class="btn-premium" style="padding: 8px 16px; font-size: 13px;" onclick="toggleChartType('bar')">Bar</button>
            </div>
        </div>
        <div class="chart-area">
                            <canvas id="threatTrendsChart"></canvas>
                </div>
            </div>

            <!-- Innovation Performance -->
    <div class="chart-container">
        <div class="chart-header">
            <h3 class="chart-title">Innovation Performance</h3>
                    </div>
        <div class="chart-area">
                            <canvas id="innovationChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Charts Row 2 -->
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-bottom: 32px;">
            <!-- Response Time Distribution -->
    <div class="chart-container">
        <div class="chart-header">
            <h3 class="chart-title">Response Time Distribution</h3>
                    </div>
        <div class="chart-area">
                            <canvas id="responseTimeChart"></canvas>
                </div>
            </div>

            <!-- Threat Categories -->
    <div class="chart-container">
        <div class="chart-header">
            <h3 class="chart-title">Threat Categories</h3>
                    </div>
        <div class="chart-area">
                            <canvas id="threatCategoriesChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Detailed Analytics Tables -->
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px;">
            <!-- Top Threats -->
    <div class="table-container">
        <h3 class="chart-title" style="margin-bottom: 24px;">Top Threat Patterns (Last 7 Days)</h3>
        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th>Pattern</th>
                    <th>Count</th>
                    <th>Severity</th>
                    <th>Trend</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                    <td><span class="badge-premium" style="background: rgba(255, 59, 48, 0.1); color: var(--danger);">1</span></td>
                                        <td>Social Engineering</td>
                                        <td><strong>47</strong></td>
                    <td><span class="badge-premium" style="background: rgba(255, 59, 48, 0.1); color: var(--danger);">HIGH</span></td>
                    <td><i class="bi bi-arrow-up" style="color: var(--danger);"></i></td>
                                    </tr>
                                    <tr>
                    <td><span class="badge-premium" style="background: rgba(255, 149, 0, 0.1); color: var(--warning);">2</span></td>
                                        <td>Hate Speech</td>
                                        <td><strong>32</strong></td>
                    <td><span class="badge-premium" style="background: rgba(255, 149, 0, 0.1); color: var(--warning);">MEDIUM</span></td>
                    <td><i class="bi bi-arrow-down" style="color: var(--success);"></i></td>
                                    </tr>
                                    <tr>
                    <td><span class="badge-premium" style="background: rgba(52, 199, 89, 0.1); color: var(--success);">3</span></td>
                                        <td>Prompt Injection</td>
                                        <td><strong>28</strong></td>
                    <td><span class="badge-premium" style="background: rgba(255, 59, 48, 0.1); color: var(--danger);">HIGH</span></td>
                    <td><i class="bi bi-dash" style="color: var(--gray-500);"></i></td>
                                    </tr>
                                    <tr>
                    <td><span class="badge-premium" style="background: var(--gray-100); color: var(--gray-600);">4</span></td>
                                        <td>Misinformation</td>
                                        <td><strong>19</strong></td>
                    <td><span class="badge-premium" style="background: rgba(255, 149, 0, 0.1); color: var(--warning);">MEDIUM</span></td>
                    <td><i class="bi bi-arrow-up" style="color: var(--warning);"></i></td>
                                    </tr>
                                    <tr>
                    <td><span class="badge-premium" style="background: var(--gray-100); color: var(--gray-600);">5</span></td>
                                        <td>Violent Content</td>
                                        <td><strong>15</strong></td>
                    <td><span class="badge-premium" style="background: rgba(255, 59, 48, 0.1); color: var(--danger);">HIGH</span></td>
                    <td><i class="bi bi-arrow-down" style="color: var(--success);"></i></td>
                                    </tr>
                                </tbody>
                            </table>
            </div>

            <!-- System Performance Metrics -->
    <div class="table-container">
        <h3 class="chart-title" style="margin-bottom: 24px;">Innovation System Performance</h3>
        <table>
            <thead>
                <tr>
                    <th>Innovation</th>
                    <th>Accuracy</th>
                    <th>Speed</th>
                    <th>Status</th>
                    <th>Load</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <i class="bi bi-brain" style="color: var(--success);"></i>
                            <span>Adaptive Learning</span>
                                            </div>
                                        </td>
                    <td><span class="badge-premium" style="background: rgba(52, 199, 89, 0.1); color: var(--success);">99.1%</span></td>
                    <td style="color: var(--gray-500);">234ms</td>
                    <td><span class="badge-premium" style="background: rgba(52, 199, 89, 0.1); color: var(--success);">ACTIVE</span></td>
                    <td>
                        <div style="width: 100%; height: 8px; background: var(--gray-200); border-radius: var(--radius-full); overflow: hidden;">
                            <div style="width: 65%; height: 100%; background: linear-gradient(90deg, var(--success) 0%, #30D158 100%);"></div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <i class="bi bi-person-check" style="color: var(--success);"></i>
                            <span>Behavioral Analysis</span>
                                            </div>
                                        </td>
                    <td><span class="badge-premium" style="background: rgba(52, 199, 89, 0.1); color: var(--success);">97.8%</span></td>
                    <td style="color: var(--gray-500);">156ms</td>
                    <td><span class="badge-premium" style="background: rgba(52, 199, 89, 0.1); color: var(--success);">ACTIVE</span></td>
                    <td>
                        <div style="width: 100%; height: 8px; background: var(--gray-200); border-radius: var(--radius-full); overflow: hidden;">
                            <div style="width: 78%; height: 100%; background: linear-gradient(90deg, var(--warning) 0%, #FF9F0A 100%);"></div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <i class="bi bi-share" style="color: var(--success);"></i>
                            <span>Federated Learning</span>
                                            </div>
                                        </td>
                    <td><span class="badge-premium" style="background: rgba(52, 199, 89, 0.1); color: var(--success);">98.9%</span></td>
                    <td style="color: var(--gray-500);">89ms</td>
                    <td><span class="badge-premium" style="background: rgba(52, 199, 89, 0.1); color: var(--success);">ACTIVE</span></td>
                    <td>
                        <div style="width: 100%; height: 8px; background: var(--gray-200); border-radius: var(--radius-full); overflow: hidden;">
                            <div style="width: 45%; height: 100%; background: linear-gradient(90deg, var(--info) 0%, #64D2FF 100%);"></div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <i class="bi bi-robot" style="color: var(--success);"></i>
                            <span>HuggingFace AI</span>
                                            </div>
                                        </td>
                    <td><span class="badge-premium" style="background: rgba(52, 199, 89, 0.1); color: var(--success);">99.5%</span></td>
                    <td style="color: var(--gray-500);">312ms</td>
                    <td><span class="badge-premium" style="background: rgba(52, 199, 89, 0.1); color: var(--success);">ACTIVE</span></td>
                    <td>
                        <div style="width: 100%; height: 8px; background: var(--gray-200); border-radius: var(--radius-full); overflow: hidden;">
                            <div style="width: 85%; height: 100%; background: linear-gradient(90deg, var(--danger) 0%, #FF453A 100%);"></div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <i class="bi bi-lightbulb" style="color: var(--success);"></i>
                            <span>Semantic Analysis</span>
                                            </div>
                                        </td>
                    <td><span class="badge-premium" style="background: rgba(52, 199, 89, 0.1); color: var(--success);">98.7%</span></td>
                    <td style="color: var(--gray-500);">198ms</td>
                    <td><span class="badge-premium" style="background: rgba(52, 199, 89, 0.1); color: var(--success);">ACTIVE</span></td>
                    <td>
                        <div style="width: 100%; height: 8px; background: var(--gray-200); border-radius: var(--radius-full); overflow: hidden;">
                            <div style="width: 58%; height: 100%; background: linear-gradient(90deg, var(--success) 0%, #30D158 100%);"></div>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
{% endblock %}

{% block scripts %}
    <script>
        // Chart instances
        let threatTrendsChart, innovationChart, responseTimeChart, threatCategoriesChart;
    let currentChartType = 'line';

        // Initialize all charts
        function initializeCharts() {
            initThreatTrendsChart();
            initInnovationChart();
            initResponseTimeChart();
            initThreatCategoriesChart();
        }

        // Threat Trends Chart
        function initThreatTrendsChart() {
            const ctx = document.getElementById('threatTrendsChart').getContext('2d');
            threatTrendsChart = new Chart(ctx, {
            type: currentChartType,
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [
                        {
                            label: 'Threats Detected',
                            data: [12, 19, 8, 25, 15, 22, 18],
                        borderColor: 'rgb(255, 59, 48)',
                        backgroundColor: 'rgba(255, 59, 48, 0.1)',
                            fill: true,
                        tension: 0.4,
                        borderWidth: 3
                        },
                        {
                            label: 'False Positives',
                            data: [2, 1, 3, 2, 1, 2, 1],
                        borderColor: 'rgb(255, 149, 0)',
                        backgroundColor: 'rgba(255, 149, 0, 0.1)',
                            fill: true,
                        tension: 0.4,
                        borderWidth: 3
                        },
                        {
                            label: 'Blocked Content',
                            data: [8, 15, 6, 20, 12, 18, 14],
                        borderColor: 'rgb(107, 114, 128)',
                        backgroundColor: 'rgba(107, 114, 128, 0.1)',
                            fill: false,
                        tension: 0.4,
                        borderWidth: 3
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        labels: {
                            usePointStyle: true,
                            padding: 20,
                            font: { family: 'Inter', size: 13, weight: '600' }
                        }
                        }
                    },
                    scales: {
                        y: {
                        beginAtZero: true,
                        grid: { color: 'rgba(0, 0, 0, 0.05)' },
                        ticks: { font: { family: 'Inter', size: 12 } }
                    },
                    x: {
                        grid: { display: false },
                        ticks: { font: { family: 'Inter', size: 12 } }
                        }
                    }
                }
            });
        }

        // Innovation Performance Pie Chart
        function initInnovationChart() {
            const ctx = document.getElementById('innovationChart').getContext('2d');
            innovationChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Adaptive Learning', 'Behavioral Analysis', 'Federated Learning', 'HuggingFace AI', 'Semantic Analysis'],
                    datasets: [{
                        data: [22, 18, 15, 25, 20],
                        backgroundColor: [
                        'rgba(52, 199, 89, 0.8)',
                        'rgba(255, 149, 0, 0.8)',
                        'rgba(90, 200, 250, 0.8)',
                        'rgba(255, 59, 48, 0.8)',
                        'rgba(107, 114, 128, 0.8)'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                            usePointStyle: true,
                            font: { family: 'Inter', size: 12, weight: '600' }
                            }
                        }
                    }
                }
            });
        }

        // Response Time Histogram
        function initResponseTimeChart() {
            const ctx = document.getElementById('responseTimeChart').getContext('2d');
            responseTimeChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['0-100ms', '100-200ms', '200-300ms', '300-400ms', '400-500ms', '500ms+'],
                    datasets: [{
                        label: 'Frequency',
                        data: [145, 289, 167, 89, 45, 12],
                        backgroundColor: [
                        'rgba(52, 199, 89, 0.8)',
                        'rgba(52, 199, 89, 0.6)',
                        'rgba(255, 149, 0, 0.6)',
                        'rgba(255, 149, 0, 0.8)',
                        'rgba(255, 59, 48, 0.6)',
                        'rgba(255, 59, 48, 0.8)'
                    ],
                    borderWidth: 0,
                    borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                    legend: { display: false }
                    },
                    scales: {
                        y: {
                        beginAtZero: true,
                        grid: { color: 'rgba(0, 0, 0, 0.05)' },
                        ticks: { font: { family: 'Inter', size: 12 } }
                    },
                    x: {
                        grid: { display: false },
                        ticks: { font: { family: 'Inter', size: 12 } }
                        }
                    }
                }
            });
        }

        // Threat Categories Radar Chart
        function initThreatCategoriesChart() {
            const ctx = document.getElementById('threatCategoriesChart').getContext('2d');
            threatCategoriesChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Hate Speech', 'Violence', 'Social Eng.', 'Misinformation', 'Harassment', 'Spam'],
                    datasets: [{
                        label: 'Detection Rate',
                        data: [95, 98, 92, 88, 94, 99],
                    borderColor: 'rgb(0, 122, 255)',
                    backgroundColor: 'rgba(0, 122, 255, 0.2)',
                    pointBackgroundColor: 'rgb(0, 122, 255)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgb(0, 122, 255)',
                    borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                        ticks: { stepSize: 20, font: { family: 'Inter', size: 12 } },
                        grid: { color: 'rgba(0, 0, 0, 0.05)' }
                        }
                    },
                    plugins: {
                    legend: { display: false }
                    }
                }
            });
        }

    // Toggle chart type
    function toggleChartType(type) {
        currentChartType = type;
        if (threatTrendsChart) {
            threatTrendsChart.destroy();
            initThreatTrendsChart();
        }
        }

        // Refresh analytics data
        function refreshAnalytics() {
            console.log('Refreshing analytics data...');
        }

        // Handle time range changes
        document.getElementById('time-range').addEventListener('change', function() {
            const timeRange = this.value;
            console.log('Time range changed to:', timeRange);
            refreshAnalytics();
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
        });
    </script>
{% endblock %}